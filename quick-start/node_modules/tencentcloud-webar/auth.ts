
// 鉴权相关
import { Auth } from 'src/auth'
import { AuthData } from 'src/auth'

let auth: Auth

export async function authorize(
  licenseKey: string,
  appId: string,
  authFunc:()=>Promise<AuthData>,
  language? : string
) {
  /* IFTRUE_platform_h5*/
  auth = new Auth(licenseKey, appId, authFunc)
  /*FITRUE_platform_h5*/

  /* IFTRUE_platform_wx*/
  //@ts-ignore
  const accountInfo = wx.getAccountInfoSync()
  const wxappid = accountInfo.miniProgram.appId
  auth = new Auth(licenseKey, appId, authFunc, wxappid)
  /*FITRUE_platform_wx*/
  language && (auth.language = language)
  await auth.go()
  return {
    getEffectList: auth.getEffectList.bind(auth),
    getFilterList: auth.getFilterList.bind(auth)
  }
}
/*IFTRUE_platform_wx*/
export {authorizeWxCamera} from './src/wx/authorize'
/*FITRUE_platform_wx*/